import csv
from tqdm import tqdm
from canada_diamond import dataExtractor

def saveData(url, start, end):
    data = dataExtractor(url)
    with open('Canadian_diamond_assocaition_'+ str(start) + '_'+ str(end) + '.csv', 'a', newline='') as file:
        writer = csv.DictWriter(file, fieldnames=['Membership Level', 'Organization','First Name','Last Name', 'Address', 'City', 'Province', 'Country', 'Phone', 'Website', 'Type Of Service', 'Postal Code', 'Description','Data_url', 'Email'])
        writer.writerow(data)
        file.close()   

def urlCreator(BASE_URL, suffix):
    codes = [54668507,60708728,51508449,51921342,57894795,51364584,51508495,51508430,50941300,51508312,50941297,51508522,51508319,55505870,51364545,50941318,53777142,51364515,51508316,51508414,59862726,58856347,56522369,51508483,51922394,59734786,51508395,51508444,52800319,51508381,50941311,51508424,55636858,51364562,51508388,51508455,51508434,51508541,51508545,51364532,51364563,51508439,51508332,52503708,51508366,51378771,51378772,51378774,51378777,51378778,51378779,51378780,51378782,51378783,51378785,51378786,51378788,51378790,51378793,51378794,51378795,51378797,51378798,51378799,51378802,51378803,51378805,51378807,51378808,51378809,51378810,51396304,51396334,51364578,58358562,51374264,51374266,51374267,51374268,51374269,51374270,51374271,51364528,56022617,51508336,51508543,51508491,51508298,59880633,50941342,51508370,51508376,58104697,51364583,51364589,51364525,51508427,51508521,51508386,52533179,57394876,51508451,56351288,51508384,51508342,51508512,51508517,51508540,57908078,59951703,59755050,54928256,51379426,54375944,54375945,54375946,54375947,54375948,54375949,54375950,54375951,54375952,54375953,54375954,54375955,54375956,54375957,54375958,54375959,54375960,54375961,54375962,54375963,54375964,54375965,54375966,54375967,54375968,54375969,54375970,54375971,54375972,54375973,54375974,54375975,54375976,54375977,54375978,54375979,54375980,54375981,54375982,54375983,54375984,54375985,54375986,54375987,54375988,54375989,54375990,54375991,54375992,54375993,54375994,54375995,54375996,54375997,54375998,54375999,54376000,54376001,54376002,51508317,51364569,53719594,51508420,51508524,60855243,57932131,51364597,51508428,51364533,51508340,52826917,51364575,51508301,51508300,51508304,51508452,51508458,51508456,51508459,51508389,58925630,51508535,50941295,51508361,51508349,51508329,52668997,57139915,51508490,58973528,51364579,50941337,51187349,51566110,50941327,51508407,51508501,52503398,51364588,58292506,59567571,51508358,51364546,51508488,50941306,51508318,56965090,51508489,51508508,51508532,51508500,56870616,52827279,51364514,51508480,51508468,55163785,50941347,51566216,51508454,56328919,53501762,51364561,51364553,51508355,51364566,50941302,51566206,51364536,51364596,51364571,50941314,51364593,51364342,51364517,58856790,51508401,51508498,53872125,51508408,51508382,56336749,51508356,51508537,51508479,51364573,51364570,51364587,51364519,51508373,51508412,51508438,51508526,51508503,51508502,56581341,51508457,51508481,50941332,51364577,55911129,56049783,51508450,51508445,51508523,51508425,51364558,56386012,51565910,51364521,53914627,50941305,50941336,51508530,50941292,50941322,53303579,51508320,56978382,51508378,51508364,51508345,51364595,51508369,51508367,59411297,51508426,50941330,51566102,51508392,51508310,53834871,51364530,51187360,51566197,51508363,53390264,53390274,51508397,54935672,51508417,56125140,51364534,53653245,51508375,51364564,51508529,51508341,51508527,51364524,51508383,59310868,50941343,54056016,54056036,51364586,50941303,51566173,58448688,51508348,55497059,51364513,60809037,51508380,51508365,51508496,51508534,51364598,51565892,51508311,55450060,51508379,51508352,56685315,56685812,51508297,51508431,51508323,51508515,53197132,50941287,51508404,51508467,51910051,51910084,51364541,51508465,51508525,50941309,51508462,51364551,51508326,54224687,51508339,51508539,51508415,51364538,60500670,58733629,51784935,54842155,58015195,51508447,51508421,51508333,51508441,51508478,54657061,51508331,53517017,51508492,51364552,51508528,51508299,55164544,51508505,51508513,51508314,51364516,51364548,56886192,52337057,52337058,52337059,52337060,52337061,52337062,52337063,52337064,52337065,52337066,52337067,52337068,52337069,52337070,52337071,52337072,52337073,52337074,52337075,52337076,52337077,52337078,52337079,52337080,51364547,51508346,51508486,59244571,51508385,60698577,51508538,51508324,51508302,51508519,52800332,51508335,51508423,51364555,57551434,51508411,51508542,51816619,51364574,51508390,51508460,52827285,51364554,51364591,56848763,51508371,52868237,51508354,51508360,51508453,57108028,51784960,51364544,51508347,51364585,59460944,51364549,51508469,51508509,51364543,59714274,51508400,51508448,57172943,51817531,51508511,51508432,51364340,57004669,50941299,56249873,51508308,51679564,56268710,51364557,50941289,51508533,51508507,51508418,50941321,51508359,55187550,51508368,50941326,51508327,54936010,57174487,55072983,50941339,51508520,51508429,51364572,58874789,57952415,51508377,51364556,54379205,51364531,59974932,51508487,50941304,56342975,51508473,59856909,52827243,56085083,58252135,51508482,51508399,59881348,52729412,51508337,55294902,51364522,59005316,50941286,51508419,51364529,57029599,55914534,51508466,53014001,51508403,60825384,51364590,51564657,51364523,51508514,51508518,51378796,51379273,51379274,51379275,51379276,51379277,51379278,51379279,51379280,51379281,51379282,51379283,51379285,51379287,51379288,51379290,51379291,51379292,51379293,51379294,51379295,51379296,51379297,51379298,51379299,51379300,51379303,51379304,51379305,51379306,51379307,51379308,51379309,51379310,51379312,51379316,51379317,51379318,51379319,51379322,51379325,51379326,51379331,51379332,51379334,51379335,51379339,51379340,51379342,51379346,51379350,51379351,51379352,51379355,51379356,51379357,51379360,51379364,51379365,51379367,51379368,51379369,51379371,51379373,51379375,51379377,51379378,51379379,51379380,51379381,51379385,51379387,51379388,51379390,51379391,51379395,51379398,51379399,51379400,51379401,51379404,51379406,51379407,51379409,51379411,51379414,51379415,51379416,51379417,51379419,51379421,51379425,51379428,51379429,51379433,51379434,51379436,51379437,51379442,51379444,51379446,51379449,51379452,51379453,51379455,51379456,51379457,51379458,51379459,51379461,51379463,51379464,51379465,51379467,51379470,51379471,51379472,51379473,51379474,51379478,51379479,51379480,51379482,51379484,51379485,51379486,51379488,51379490,51379492,51379493,51379494,51379496,51379497,51379498,51379503,51379505,51379510,51379513,51379514,51379515,51379517,51379523,51379525,51379526,51379527,51379529,51379530,51379531,51379533,51379535,51379536,51379537,51379539,51379541,51379544,51379549,51379550,51379551,51379555,51379556,51379557,51379558,51379560,51379561,51379562,51379563,51379565,51379566,51379567,51379569,51379570,51379571,51379575,51379576,51379578,51379579,51379580,51379581,51379584,51379585,51379586,51379589,51379590,51379593,51379594,51379595,51379597,51379598,51379604,51379606,51379609,51379612,51379613,51379614,51379615,51379617,51379618,51379619,51379620,51379623,51379625,51379626,51379627,51379628,51379629,51379630,51379631,51379632,51379633,51394909,51508391,53780370,51508446,53932590,54749277,54292376,49879617,50941294,50941307,50941317,50941329,50941334,50941345,51364339,51364343,51364346,51364348,51364349,51364518,51364576,51374272,51378776,51378784,51394927,51395456,51395471,51395481,51395485,51395487,51395498,51395505,51396035,51396039,51396045,51396163,51508350,51566189,53309131,53309163,53309172]
    for start in range(0,len(codes), 50):

        with open('Canadian_diamond_assocaition_'+ str(start+1) + '_'+ str(start+50) + '.csv', 'a', newline='') as file:
            writer = csv.DictWriter(file, fieldnames=['Membership Level', 'Organization','First Name','Last Name', 'Address', 'City', 'Province', 'Country', 'Phone', 'Website', 'Type Of Service', 'Postal Code', 'Description','Data_url', 'Email'])
            writer.writeheader()
            file.close()  
        
        if start + 50 > len(codes):
            end = len(codes)
        else:
            end = start + 50

        for code in tqdm(codes[start:end]):
            url = BASE_URL + str(code) + suffix
            saveData(url, start+1, start+50)

if __name__ == '__main__':
    BASE_URL = 'https://www.canadianjewellers.com/Sys/PublicProfile/'
    suffix = '/5146961'

    urlCreator(BASE_URL, suffix)